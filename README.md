# Bugsy
get RSS Feed from bug.hr


Bugsy je aplikacija koja s Bug.hr dohvaæa vijesti u XML formatu i prikazuje ih na korisnièkom suèelju. Kako bi prikaz vijesti bio èitljiv i pregledan bilo je potrebno parsirati podatke u odgovarajuæi oblik kako bi se spremili u obliku objekata klase News. Dohvaæanje podataka se izvodi na posebnoj niti pomoæu klase AsyncTask. Vijesti se prikazuju u obliku kartica (CardView) u RecyclerView-u. Dodatna moguænost aplikacije je spremanje odabranih vijesti u lokalnu bazu podataka da ih korisnik može dohvatiti u bilo koje vrijeme. 

Za dohvaæanje podataka, tj. uspostavljanja HTTP veze sa stranicom bug.hr koristi se metoda getData() unutar klase RssFeed koja nasljeðuje klasu AsyncTask. Metoda getData() se poziva unutar preoptereæene metode doInBackground(), a ona uspostavlja HTTP konekciju i šalje zahtjev za dohvaæanje podataka. Za prihvaæanje podataka koristi se objekt klase InputStream koji se predaje metodi parse() klase ParseXml. 

U klasi ParseXml se na temelju InputStream objekta dobiveni podaci parsiraju i spremaju u obliku News objekta. Cijela prièa se dogaða u metodi parse(InputStream) koja koristi objekte klasa XmlPullParserFactory i XmlPullParser za parsiranje podataka. Metodom getEventType() objekta XmlPullParser klase se uz pomoæ switch-a odreðuje što se dogaða s podacima, ukoliko getEventType() vraæa START_TAG koji je jednak XML elementu "item" znaèi da se radi o novim vijestima i stvara se novi objekt klase News. Ukoliko metoda getEventType() vraæa TEXT, dohvaæa se tekst unutar proèitanog XML atributa i sprema se u String, a na temelju vraæene vrijednosti END_TAG metode getEventType() se postavljaju atributi objekta klase News na proèitan tekst. Metodom next() XmlPullParser-a se dohvaæa sljedeæi XML element.

Nakon dohvaæanja svih vijesti poziva se metoda onPostExecute() klase RssFeed iz koje se poziva metoda setUI() klase MainActivity. U MainActivity-u se nakon izvoðenja niti tj. vraæanja liste objekata News sve kategorije postavljaju u objekt klase Spinner pomoæu kojeg se odabiru kategorije koje æe se prikazati u RecyclerView-u. Nakon toga se postavlja RecyclerView kojem se uz listu objekata klase News i objekta klase Context šalje i boolean varijabla koja oznaèava koji ViewHolder æe se koristiti. Ukoliko je boolean varijabla jednaka "false" tada se kreira ViewHolder koji ne sadrži checkBox-ove, a ukoliko se proslijedi "true" kreira se ViewHolder koji uz lijevi rub ekrana prikazuje checkBox-ove. Potreba za korištenjem dva ViewHolder-a se pojavila zbog višestrukog odabira objekata iz RecyclerView-a. Prilikom dugog klika na bilo koji element RecyclerView-a kreira se ViewHolder s checkBox-ovima koje je moguæe oznaèiti, a pritiskom na FloatingActionButton za spremanje u bazu, odabrani objekti se spremaju u lokalnu bazu podataka. Kako bi se saznalo koji objekti su oznaèeni bilo je potrebno u klasu News dodati i boolean atribut koji govori je li objekt oznaèen ili nije. 

U aplikaciji je dostupno i "pull to refresh" osvježavanje vijesti pomoæu widget-a SwipeRefreshLayout. Funkcionalnost je postignuta vrlo lako, nakon instanciranja objekta potrebno je postaviti metodu setOnRefreshListener() u kojoj se odredi što aplikacija treba napraviti prilikom osvježavanja (ponovno uèitavanje podataka s bug.hr). Prilikom aktiviranja osvježavanja pojavi se "progressBar" koji je nakon uèitavanja podataka potrebno maknuti, a to se radi metodom setRefreshing(false).
Lokalna baza podataka radi na istom principu kao baza podataka prikana na vježbama.
